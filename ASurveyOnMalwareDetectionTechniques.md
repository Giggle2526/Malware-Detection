# A Survey on malware detection techniques

恶意软件已经成为一个严重的威胁，因为它被开发出来破坏计算机系统，通过网络或互联网连接传播。研究人员正努力开发具有实用方法的反恶意软件系统，以检测恶意软件保护和恶意软件检测的计算机系统。提出了两种准确检测已知恶意软件基本方法:基于签名和检测的启发式规则。然而，由于无法识别未知恶意软件、代码混淆、打包、多态和变形等恶意软件，基于签名的检测技术被认为是无效的。这篇调查论文强调了当前检测和分析恶意代码的方法。

**关键词**：恶意软件检测，安全，调查恶意程序，静态分析，动态分析，混合分析。

## I. Introduction

恶意软件主要目的是在不知情和未经系统所有者同意的情况下渗透计算机系统。恶意软件可以是敌对的，破坏性的，侵入性的，也许它的构造是良性的，但它的存在导致了不便（软件结构正常，但用途具有恶意性，如间谍软件）。

病毒，蠕虫，木马，rootkit，间谍软件都是不同形式和类型的恶意程序。然后根据传播的方法和目的对其进行分类。它的各种形式可以让其他人监视设备，启动恼人的弹出广告，在不知情的情况下从账户发送电子邮件，最坏的情况是，几乎从内部摧毁系统

在许多研究中，我们一直在警惕这些威胁对金融机构的影响，例如勒索软件的概念。该恶意软件隐藏所有文件夹，并对PC机C:驱动器上的文件进行加密。1989年，一种名为PC Cyborg的木马病毒被传播，该脚本要求向PC Cyborg公司支付189美元的赎金。受影响的计算机将无法工作，直到支付了赎金，恶意软件的行为被逆转。从那时起，这类威胁得到了很多改进，尤其是在文件加密[12]中，勒索软件是一种恶意软件，它威胁要公布受害者的数据，或者永远阻止对数据的访问，除非支付赎金。它通常通过锁定受害者的桌面使用户无法访问系统，或者通过加密、覆盖或删除用户来操作。

不同类型的恶意软件可以降低计算机的运行速度，或者替换浏览器中的网页，从而让黑客控制系统。

有时恶意软件显示网页或广告，旨在为恶意软件创作者牟利，例如木马或rootkit,从电脑锁,通过控制系统的黑客控制机密或敏感信息,如银行细节,信用卡号码,个人数据,甚至使用电脑黑客或伤害他人,如果电脑被恶意软件控制,它将无法自发改善这一情况,只能删除必要的恶意软件，使计算机回到正轨，并改进它。因此，有必要使用一种方法来检测勒索软件和多态程序和其他恶意程序消除他们。

研究人员注意到，恶意软件在结构上有显著的演化进程，但每个阶段都有一个固定的属性。所有恶意软件的设计都是利用一种异常的方式，采取一些行动来实现其目标。假设存在恶意软件在Windows设备,它将需要使用一些服务提供的Windows操作系统(Windows API调用)来生成恶意行为,所以恶意软件检测,分类,和行为分析可以执行基于动态分析来确定他们的行为通过Windows API调用[9]。

这篇论文是对恶意软件基础的一个调查性研究。第二部分总结了相关工作。第三节讨论恶意软件分析技术。第四节恶意软件检测方法。第五节解释了WINDOWS API调用。在第六节，恶意软件检测系统的一个广泛的回顾被提出。第七部分对全文进行了总结。

## II. Related Work

由于恶意软件在信息上传播的巨大风险和对用户计算机系统的严重威胁，帖子引起了研究人员的极大兴趣，并从帖子信息中获益。

恶意软件检测开发人员已经率先提出了解决方案;因为攻击者用非法的方式开玩笑或获取利益，并在所有领域威胁他人:

应用于[1]的研究工作评估了两种方法，它们是**最长公共子序列和最长公共子串算法**，在恶意软件检测率和误报的背景下缓解计算复杂性，因此，不能扩展到大型API调用序列，结果是LCSS在检测率和误报率方面比LCS更好，因为它使用回溯方式来构造子序列。

另一项研究在[2]分析中，通过**挖掘API调用的行为信息**，使用API调用的提取和解释信息作为输入，调用已提出的可以标识唯一API的算法，将PE文件划分为恶意和良性从而检测恶意软件。类似地，在[3]框架中研究基于挖掘API调用的工作，框架包括PE分析器、特征生成器、选择器和分类器，PE分析器从PE导出Windows API调用后，生成各种特征并选择形成API调用集，并应用良性或恶性的分类方法。

还有一个研究[4]方法分析**API调用序列**而不是依靠每个类的API, API调用序列提取模式的恶意软件在不同阶层关注常见的恶意软件功能,该公司已经根据经验开发出一种**签名数据库**和APIMDS，其有着更准确的结果和更低出错率。此外，检测系统依赖于恶意软件的签名固定信息，如文件大小、进程和其影响。因此，必须始终更新签名，以确保流程不会失败；在[5]的进一步研究工作中，提出了一个**基于API调用序列比较的聚类框架**来检测类似的恶意软件行为，其搜索三个序列比较函数的结果，即LCS、OM和LCP，作为聚类的基础，其中LCP函数在最低的时间复杂度下提供了最好的聚类质量，这使得其在诸多同类的恶意软件探测软件中成为了快速而稳定的存在。

在[6]的一项研究中认为：API调用不能代表应用程序的所有行为，所以其有两个特性类别:在运行时提取API名称、API名称及其输入的一小组API的组合，从而得到他们所产生的影响进而进行分类；此外，研究[7]重点关注API调用序列中频繁使用的信息，利用API调用序列的频繁消息可以在减少计算时间的同时实现对恶意程序的高精度聚类，也证明了API调用序列中频繁项集对识别恶意程序行为的重要性。另一项研究利用基于API调用序列的RNN-LSTM技术，利用N-gram进行特征提取，TF-IDF进行序列特征选择，实现了[8]恶意软件检测的高精度，对未知恶意软件进行基于行为的分类。

Morgan C. Wang等人在研究[20]中使用了**静态分析**方法，使用数据提取技术自动从所有程序中提取关键行为，使用了从正常软件中提取的指令序列，去除恶意软件的一个基本分类特征。他们将这个问题表述为一个二元分类问题，逻辑回归、神经网络和决策树模型的构建。

在另一篇论文[21]中，研究了利用**新的特征集**解决移动/ Android恶意软件检测问题，并对恶意软件检测进行了分析;通过随机森林分类器等机器学习编译，在TPR / FPR指标下取得了更好的结果。SVM与Random Forest在对正常数据的真阳（True Positive）性和恶意软件数据的假阳（False Positive）性表现相似。

此外，研究[22]提出了对于恶意软件早期的一种检测方法，其运行于Android系统上，使用平行机器学习技术，使用了多种不同的算法自然而然地提高了准确率，该方法使用了固定的一些应用的特征，并将其与诸如API链接调用(API-linked calls)与训练模型的结果进行比较，利用了和大量事物绑定的命令，给出了一个组合模型，该模型将新应用进行“存疑”和“良性”的初步判断与分类。

一些研究解释了在Android应用程序中阅读许可系统说明的重要性，有助于提高对风险的认识。但是，我们不能保证所有用户都能阅读或理解它们，因此Kabakus Abdullah Talha等人[23]引入了一个运行APK Auditor的恶意软件检测系统，该系统由三部分组成：一个用于存储应用程序分析生成的信息的签名数据库，最终用户用于授予应用程序分析请求的Android客户端，以及负责与数据库、签名和智能手机客户端通信的中央服务器，管理整个分析过程，并为Android应用程序分析提供两种方法：通过Play Store搜索，并下载应用程序（.apk文件）以分析来自其他Android源的应用程序。此外，根据Hardy Jiang等人[24]的建议，**利用DLGraph恶意软件检测图**中包含的深度学习方法，解决了缺乏识别新恶意软件的基于签名的方法意识的问题。它使用两个堆叠的自动编码设备（SDA）来学习表示，考虑使用图形来调用计算机软件功能，并使用Windows API，其中一个SDA可以学习图形的底层表示和软件调用功能。其他SDA可以看到Windows API调用程序的潜在表示形式。 

## III. Malware Detection Techniques

恶意软件分析是开发有效的恶意软件检测技术的必要步骤。这是一个分析目标和恶意软件如何执行其工作的过程，以便开发人员更容易检测到这些程序以及避免这些程序所需的工作，根据时间和技术分为三类进行分析[11,25]。 

### A. 静态分析检测技术

静态分析即在执行和运行程序之前，在编码和单元测试之间自动更正源代码中的错误。应用程序使用反汇编工具、反编译工具、调试器、源代码分析器工具Ollydbg进行划分，以了解恶意软件及其结构。静态分析解决了源代码中的弱点，以避免安全漏洞，源代码可以手动审查，但机器工具是实际的。

优点[28]：

	1. 快速、安全
	2. 可以收集被检查程序的代码结构。 
	3. 如果静态分析可以计算应用程序中的恶意软件行为，则可以使用此信息。 

缺点[28]：

	1. 静态分析无法分析未知恶意软件。此外，许多程序的源代码也不容易获得。 
	2. 为了进行静态分析，研究人员必须对汇编语言有很好的了解，并对操作系统的功能有深入的了解。 

### B. 动态分析检测技术

在执行过程中分析应用程序行为的过程，作为代码调试的一部分的动态代码分析允许在任何场景中测试程序，因此不需要创建虚假入口或可能产生意外错误的情况。但是，它可以在实现过程中检测到设计阶段未出现的意外问题和所需功能。不可能确定所有可能的情况，这是一个标准程序，因为它减少了测试成本和时间，同时便于维护[27]。 

在测试阶段还应用了动态代码分析。如果由于特定场景而出现一些错误，则它们是解决问题的唯一选项。 

优点[28]:

1. 它能够检测在静态分析中无法检测到的依赖项，例如：使用反射的动态依赖项、依赖项注入、多态性。 
2. 可以收集时态信息。处理真实的输入数据，因为在静态分析过程中，很难知道哪些文件将作为输入传递，哪些WEB请求将出现，哪些用户将单击等等。 

缺点[28]:

1. 可能会对应用程序的性能产生负面影响。 
2. 无法保证源代码的完全覆盖，因为它是基于用户交互或自动测试运行的。 

### C. 混合分析检测技术

该技术是静态分析和动态分析的结合；该过程首先检查被检查代码中是否存在任何恶意软件签名，然后监控代码的行为[15]。 

## IV. Malware Detection Methods

恶意软件检测技术用于识别、检测恶意软件，防止计算机系统受到感染，防止信息丢失。它们可以分为基于签名的检测、基于行为的检测和沙箱。 

### A. 基于签名的检测

基于信号的检测使用特征码或比特序列来识别恶意软件及其类型，程序具有唯一代码，当文件访问计算机时，恶意软件扫描程序会将代码收集到基于云的数据库中。 

该数据库包含广泛的病毒代码。假设文件模式与恶意软件列表中的模式匹配。在这种情况下，数据库确定该文件为恶意文件，并被计算机上的反恶意软件程序拒绝，并在反病毒程序拆除受感染的文件并识别其模式和序列后删除，以确定其类型，如果不匹配并发现其为新的恶意文件，其代码被添加到恶意软件列表中，这是一种可以是静态、动态或混合的技术[13]。此外，有三种类型的特征分析用于蠕虫检测：网络负载特征；第二种类型的签名检测是文件签名；第三种类型基于日志文件分析[26]。 

优点[29]:

1. 具有广泛的可用性
2. 运行简单
3. 分类迅速
4. 对于恶意信息的可解释性强

缺点：

1. 无法检测多态恶意软件
2. (难以)在庞大的数据库中快速识别重复信息？

### B. 基于启发式规则的检测

该方式检测分类操作系统表现是否正常，从而判定已知的和未知的恶意软件攻击，从而找到解决方法。基于权重的规则或系统决策一个程序的函数所能产生的风险值。如果该值超出了预设的界限，则将执行设定在系统中的阻拦操作；比如，隔离并删除该文件，或者向服务器管理员发送警报通知[13]。

### C. 沙箱检测

沙盒是由反恶意软件程序创建的计算机内受保护的单元，包含任何未经测试或未经处理的程序或代码。它可以防止恶意软件感染，因为文件工作时不会感染主机设备。 

在沙箱内部，对文件进行观察和进一步分析，以确定其是否有害或安全，测试可能包含病毒或其他恶意代码的未经验证的程序；如果该文件是合法的，它将被发布，但如果它是有害的，它将被拒绝。 

## V. Windows API Calls

Windows API是一组广泛的函数，用于控制恶意软件与Microsoft库交互的方式，这些库使用特定的名称、术语和协议，在转移到特定函数之前必须熟悉这些名称、术语和协议。此外，Windows通常使用匈牙利API[10,30]。 

### A. API调用顺序

每个API调用都是恶意软件或良性活动在系统运行时执行的准确操作，例如：创建、读取、写入和删除文件或注册表项。 

此外，指定API字符串作为特征是由于API的调用顺序显示了与操作系统交互的行为的性质，恶意的和良性的软件都有他们的API调用模式、或是特殊的调用顺序[10,30]。

### B. 操作系统API调用

在检测Windows操作系统中的PE类型恶意软件时，使用操作系统API调用是一项很有前途的任务 

这项任务被正式定义为在隔离的沙箱环境中运行恶意软件，记录Windows操作系统的API调用，然后依次分析它们[9]。 

## VI. SURVEY OF EXISTING WORK

在当前场景中，我们将恶意软件检测和分析作为本文工作的基础。因此，我们调查了恶意软件检测和分析方法，总结如下表所示： 

### 1.基于图像深度学习算法

使用恶意软件系列和有用数据集的图像比较用于可视化恶意软件行为模式的差异。深度学习技术用于促进自我学习，以便在建议的分类中实现高精度。 

计算成本：较低

目标：它开发了一种混合深度学习模型，通过基于图像的机器学习检测和分类恶意软件，该模型具有成本效益和可扩展性。 

准确度：99%

### 2. 基于主机代理的云计算算法

第一个组件是一个轻量级主机代理，用于识别所有新文件并将其传输到网络服务，网络服务接收主机代理发送的所有文件，然后分析文件中所有不需要的有害内容，并指示主机访问文件是否安全。最后一步是档案和诊断服务。此组件维护所有分析的文件记录，并创建查询和工作警报接口。 

计算成本：低

目标：云环境功能更加强大，通过克服病毒问题实现了保护。 

准确度：NA

### 3. AMD框架

AMD框架包含一个VM操作员，该操作员通过使用二进制bat算法创建固定特征，然后将其移动到虚拟机监控程序，使用随机林分类器实现异常检测，从而使用签名和异常检测来检测已知恶意软件。 

挑战：由于云计算的分布式和动态特性，虚拟化导致了云计算的安全问题。 

计算成本：可承受的计算成本

目标：云计算的高风险虚拟机通过检测恶意软件保护虚拟机的可执行文件。

准确度：>96%

### 4. 开源多平台工具Yara

根据Nessus 6.8中的Yara签名扮演文件系统扫描角色，查找磁盘文件的特定文件哈希。扫描多个设备是一个很好的选择，无需安装Yara，使用ClamAV，确定恶意软件位于设备上并进行处置，此外，使用ClamAV 0.99的Yara规则也很容易，因为Yara规则文件放置在病毒数据库网站ClamAV中并运行反病毒程序。 

挑战：Nessus不是一个免费的开源软件工具，它包含一个没有价格的版本。 

计算成本：可以降低成本

目标：通过对Mirai僵尸网络安全性的深入分析，正是恶意软件影响了银行系统的可用性，并为互联网设备的DDoS攻击提供了新的证据。此外，提出缓解类似恶意软件的方案。

准确度：NA

### 5. DeepAM：异构深度学习框架

提取Windows API调用然后使用构造的分类模型进行解析，该模型由一个自动编码器工具（与Boltzmann的多层约束设备（RBM）堆叠）和一层关系内存组成，用于检测新的未知恶意软件，然后将每个未知文件标记为良性或恶意。 

挑战：如何对自动编码器施加稀疏性限制，以及如何改进堆叠RBM以获得更好的检测性能。 

计算成本：高成本

目标：基于从PE文件提取的Windows API调用的恶意软件检测

准确度：98%

### 6. 动态分析方法使用一些分类算法，如NB、BayseNet、IB1、J48和回归算法。 

首先，使用我们提出的恶意软件检测应用程序的行为分析，将用于执行恶意软件行为历史记录的XML文件转换为非绑定数组。该矩阵转化为WEKA输入数据集，以证明性能效率。使用WEKA工具将所提出的方法应用于实际案例研究数据集。 

挑战：高复杂性。分析一个真正的行为防病毒平台。 

目标：提出一种新的数据挖掘方法是基于分类方法来检测恶意软件行为。 

准确度：>86%

### 7. 基于操作码序列出现的频率

按照以下步骤的顺序计算操作码的适用性：基于新的基本汇编程序7拆卸可执行文件以获得汇编文件。然后，使用生成的程序集文件创建操作码，每个文件都包含一个列表，其中包含激活码以及每个操作码出现在恶意和恶意软件数据集中的时间。最后一步根据每个数据集中出现的频率计算操作码的重要性。 

挑战：恶意软件数据库的可扩展性。检测并面向打包的可执行文件。 

目标：训练机器学习算法以检测未知的恶意软件变体

准确度：90%

### 8. 神经模糊分类器（EHNFC），用于使用基于权限的功能对Android恶意软件进行分类。 

EHNFC使用修改后的ECM在在线模式下创建不断演变的模糊规则，将Android应用程序（.apk）文件分类为恶意软件或良性程序。 

挑战：未考虑Android应用程序的动态分析。运行时开销。 

目标：对安卓恶意软件检测系统进行了改进。此外，通过学习新的恶意软件检测模糊规则来进化EHNFC结构。 

准确度：90%

### 9. 基于行为的检测

使用API调用技术对恶意软件数据集执行动态分析，以跟踪恶意软件模型的API调用。然后，我们将处理更多的API调用，这些API调用随后进入逻辑上相关的API调用组。 

挑战：不适用于外部事件的样本。存在分析。提取技术不是全自动的。 

目标：恶意软件在运行时显示了对恶意软件操作的描述。此外，利用有前途的API调用来检测恶意软件。 

### 10. 使用系统调用组的基于图的模型

该模型基于结构相似性度量两个图形之间的相似性，并使用度量相似性计算两个GR类型图形之间的欧氏距离。 

挑战：高时间消耗 

目标：利用系统调用组之间的关系检测恶意软件

准确度：94.7%

### 11. 使用XG Boost、RF和DNN分类器的机器学习模型

用于恶意代码的**API序列**通过动态分析提取出来，作为机器学习的特征数据，有效区分恶意代码和良性文件。 之前通过执行静态和动态分析并将其应用到使用 KISIS 提供的恶意软件数据集的软件来使用提取的特征数据。 将特征选择过程应用于提取的特征数据，以减少特征数量，从而使学习模型能够有效运行。

挑战：研究可以极大地改进实现的特性，使用花费最少时间提取的轻量级特性。 

目标：使用静态和动态恶意软件分析工具从7000个恶意软件和3000个良性文件中提取特征数据 

准确度：96.3%

### 12. KNN

该模型基于对 API 调用序列的分析和分类。 该数据集来自 Kaggle，由 42,797 个恶意 API 调用序列和 1,079 个无害 API 序列组成。 KNN 算法应用于数据集以创建检测恶意软件的模型。

目标：该模型对于检测计算机系统的实时入侵具有重要意义。 

准确度：98.17%

## VII. Conclusion

恶意软件是一种全球性的瘟疫。 研究表明恶意软件的影响正在变得更糟。 恶意软件检测设备是防御反恶意软件的领先设备。 这种检测设备的准确性由它使用的方法指定。 因此，必须研究恶意软件检测技术并了解其优势和局限性。本文重点介绍了恶意软件技术现状的详细回顾，介绍了恶意软件检测技术。它总结了几种恶意软件检测系统。虽然恶意软件检测系统由于快速发展而过度增长，但本研究可作为该领域开发人员的参考。 